<!doctype html>
<html>
  <head>
    <title>devola2 by vonqo</title>
    <meta charset="UTF-8">
    <meta name="author" content="vonqo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="styles/augmented-ui.min.css">
    <link rel="stylesheet" href="styles/index.css">
    <script language="javascript" type="text/javascript" src="libs/p5js/p5.min.js"></script>
    <script language="javascript" type="text/javascript" src="libs/p5js/addons/p5.sound.min.js"></script>
    <script type="text/javascript" language="javascript" src="styles/jquery-1.8.2.min.js"></script> 
    <script type="text/javascript" language="javascript" src="data.js"></script> 

    <script language="javascript" type="text/javascript" src="src/debugger/audio/audio.js"></script>
    <script language="javascript" type="text/javascript" src="src/debugger/color/color.js"></script>
    <style>
      body, button {
        cursor:crosshair;
      }
    </style>
  </head>
  <body>
    <div class="grid-bg">
      <div style="display: flex; flex-wrap: wrap; padding: 10px; gap: 30px">

        <div class="ui-panel">

          <!-- ---------- TIME ---------- -->
          <div>
            <span id="time-hr"></span>
            <span>:</span>
            <span id="time-min"></span>
            <span>:</span>
            <span id="time-sec"></span>
          </div>

          <!-- ---------- VISUALS ---------- -->
          <div data-augmented-ui-border data-augmented-ui="b-clip-x tl-clip tr-2-clip-y br-clip bl-clip" class="visuals-wrapper">
            <div style="display: flex; align-content: stretch; gap: 10px;">
              <div class="ui-card">
                <div class="ui-title ui-bg-dark-grey"><span class="ui-text-orange">|</span>Visuals</div>
                <div class="ui-content">
                  <div class="ui-vis-item">BLMD_GLITCH</div>
                  <div class="ui-vis-item">BLMD_MIRROR</div>
                  <div class="ui-vis-item">BLMD_MENGER</div>
                </div>
              </div>
              <div class="ui-card">
                <div class="ui-title ui-bg-orange">Active Visuals</div>
                <div class="ui-content">
                  <div class="ui-vis-item">BLMD 1</div>
                  <div class="ui-vis-item">BLMD 2</div>
                  <div class="ui-vis-item">BLMD 3</div>
                </div>
              </div>
              <div class="ui-card" style="width: 60%;">
                <div class="ui-title ui-bg-orange ui-bg-stripe">Keybind</div>
                <div class="ui-content">
                  <div class="ui-vis-item">BLMD 1</div>
                  <div class="ui-vis-item">BLMD 2</div>
                  <div class="ui-vis-item">BLMD 3</div>
                </div>
              </div>
            </div>
            <div class="ui-footer ui-bg-light-grey">
            </div>
          </div>
        </div>

        <div class="ui-panel">

          <!-- ---------- SETTINGS ---------- -->
          <div data-augmented-ui-border data-augmented-ui="tl-clip tr-2-clip-y br-clip bl-clip" class="settings-wrapper">
            <div class="ui-card">
              <div class="ui-title ui-bg-orange">Settings</div>
              <div data-augmented-ui-border class="ui-bg-stripe ui-content">
                
                <div class="ui-settings-container">
                  <div>
                    <div>Audio Source</div>
                  </div>
                  <div>
                    <div>Resolution</div>
                  </div>
                  <div>
                    <div>Overlay</div>
                  </div>
                  <div>
                    <div>Transition</div>
                  </div>
                </div>
                
              </div>
            </div>
          </div>
          
          <div style="display: flex; gap: 20px;">

            <!-- ---------- AUDIO ---------- -->
            <div data-augmented-ui-border data-augmented-ui="tl-clip tr-clip br-clip bl-clip" class="monitor-wrapper">
              <div class="ui-card">
                <div class="ui-title ui-bg-dark-grey" style="justify-content: space-between;">
                  Audio / p5.sound
                  <button data-augmented-ui="tr-clip" class="ui-bg-orange ui-title-action">
                    RE
                  </button>
                </div>
                <div id="p5sound">
                </div>
              </div>
            </div>

            <!-- ---------- COLOR ---------- -->
            <div data-augmented-ui-border data-augmented-ui="tl-clip tr-clip br-clip bl-clip" class="monitor-wrapper">
              <div class="ui-card">
                <div class="ui-title ui-bg-dark-grey" style="justify-content: space-between;">
                  Color / shader
                  <button data-augmented-ui="tr-clip" class="ui-bg-orange ui-title-action">
                    RE
                  </button>
                </div>
                <div id="p5color" style="height: 200px;">
                </div>
              </div>
            </div>
          </div>

          <!-- ---------- ACTIONS ---------- -->
        <div>
          <button>Debug</button>
          <button>Start</button>
        </div>

        </div>

        

      </div>

    </div>
  </body>

  <script language="javascript" type="text/javascript">

    $(document).ready(function(e) {
      console.log(VISUAL_DATA);

      let sound = new p5(audioDebug, document.getElementById('p5sound'));
      let color = new p5(colorDebug, document.getElementById('p5color'));

      var time_hr = document.getElementById('time-hr');
      var time_min = document.getElementById('time-min');
      var time_sec = document.getElementById('time-sec');

      function time() {
        var d = new Date();
        var s = d.getSeconds();
        var m = d.getMinutes();
        var h = d.getHours();
        time_hr.textContent = ("0" + h).substr(-2);
        time_min.textContent = ("0" + m).substr(-2);
        time_sec.textContent = ("0" + s).substr(-2);
      }

      setInterval(time, 1000);
    });

    let checkSettings = async () => {
      const w = localStorage.getItem("width");
      const h = localStorage.getItem("height");
      const debug = localStorage.getItem("debug");
      const input = localStorage.getItem("micDeviceId");

      if(w === null || w == undefined) {
        localStorage.setItem("width", 1920);
      }

      if(h === null || h == undefined) {
        localStorage.setItem("height", 1080);
      }

      if(debug == null || h == undefined) {
        localStorage.setItem("debug", false);
      }

      if(input === null || input == undefined) {
        let devices = await navigator.mediaDevices.enumerateDevices();
        devices.every((deviceInfo, index) => {
          if(deviceInfo.kind === 'audioinput') {
            localStorage.setItem("micDeviceId", deviceInfo.deviceId);
            return false;
          }
          return true;
        });
      }
    }

    checkSettings();
  </script>
</html>